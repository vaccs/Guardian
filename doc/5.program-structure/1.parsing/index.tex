
\section{Parsing}
{
	The parser that Guardian uses to read its input files is generated by Zebu.
	Zebu generates data structures for representing the content that it has
	read, these data structures match almost perfectly with the behavior
	Guardian has for creating grammar values from grammar rule patterns.
	
	Guardian maintains a list of the files is currently or has completed
	reading (Internally stored as a \texttt{struct} with \texttt{stat(2)}'s
	\texttt{st\_dev} and \texttt{st\_ino} fields).
	Guardian starts with the first file,
	calling zebu's generated function to parse the
	file.
	Guardian iterates over the root-level entities in
	order:
	\begin{itemize}
	{
		\item If it is an \texttt{\%include} directive, the path is resolved,
		added to the list of files, and immediately parsed. If the file
		was already on the list: do nothing.
		
		\item If it is a \texttt{\%skip} directive, the regular expression
		is converted to an nfa, then dfa, then simplified and saved as the
		skip pattern. If there already is a skip pattern set, the previous
		pattern is freed.
		
		\item If it is an \texttt{\%error}, \texttt{\%warning},
			or \texttt{\%note} statement, a preliminary assertion statement
			structure
			is created at the correct assertion-level, and a reference
			to zebu's expression tree for its conditional.
		
		\item If it is a \texttt{\%print} statement, a preliminary print
			statement structure is created with a reference to
			zebu's expression tree.
		
		\item If it is a \texttt{\%parse} statement, the grammar rule pattern
			is converted to a NFA, then converted
			into a DFA, then is simplified. A preliminary
			parse statement structure is created with a reference to
			zebu's expression tree for it's path (\texttt{NULL} if using
			a path given through \texttt{argv}), and the simplified grammar
			state machine.
		
		\item If it is a variable declaration, a preliminary
			declaration statement is created with the variable name and a
			reference to zebu's expression tree.
		
		\item If it is a grammar-rule declaration, the pattern is converted
			into a NFA, then into a DFA, then simplified.
			The data structures representing the name and types of fields
			of the state machine transitions are combined into one structure
			definition, to be specialized later.
	}
	\end{itemize}
}




















